<ui:composition template="/WEB-INF/template.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core">
	<ui:define name="title">
        User Management | Admin Panel
    </ui:define>
	<ui:define name="content">
		<div class="container mx-auto px-4 py-8">
			<div class="flex justify-between mb-3">
				<h1 class="text-4xl font-bold mb-4">User Management</h1>
				<p:commandButton value="Add User" type="button" icon="pi pi-plus"
					onclick="PF('userDialogVar').show()" />

			</div>

			<p:dialog header="Create User" widgetVar="userDialogVar"
				minHeight="50" width="360" showEffect="fade" minimizable="true"
				maximizable="true" modal="true">
				<h:form styleClass="mt-8 space-y-6">
					<div class="rounded-md shadow-sm -space-y-px">
						<div>
							<p:outputLabel for="username" value="Username"
								styleClass="font-bold text-xl" />
							<p:inputText id="username" value="#{adminBean.newUser.username}"
								styleClass="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm" />
						</div>
						<div>
							<p:outputLabel for="password" value="Password"
								styleClass="font-bold text-xl" />
							<p:inputText id="password" value="#{adminBean.newUser.password}"
								styleClass="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm" />
						</div>
					</div>
					<div>
						<p:commandButton value="Create User" action="#{adminBean.addUser}"
							update="message" styleClass="ui-button-info" />
					</div>
				</h:form>
			</p:dialog>

			<h:form id="form">
				<p:growl id="msgs" showDetail="true" />
				<div class="card">
					<p:dataTable id="usersTable" var="user"
						value="#{adminBean.userList}" editable="true"
						style="margin-bottom:20px" paginator="true"
						paginatorPosition="both"
						paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
						currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
						rowsPerPageTemplate="5,10,{ShowAll|'All'}">

						<p:ajax event="rowEdit" listener="#{adminBean.onRowEdit}"
							update=":form:msgs" />
						<p:ajax event="rowEditCancel" listener="#{adminBean.onRowCancel}"
							update=":form:msgs" />

						<p:column headerText="Username">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{user.username}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{user.username}" style="width:100%"
										label="Username" />
								</f:facet>
							</p:cellEditor>
						</p:column>

						<p:column headerText="Password">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{user.password}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{user.password}" style="width:100%"
										label="Password" />
								</f:facet>
							</p:cellEditor>
						</p:column>

						<p:column style="width:6rem">
							<p:rowEditor />
						</p:column>
						<p:column style="width:3rem">
							<p:commandButton icon="pi pi-trash"
								action="#{adminBean.deleteUser(user.id)}"
								update=":form:msgs :form:usersTable" />
						</p:column>
					</p:dataTable>

				</div>

			</h:form>

		</div>
	</ui:define>
</ui:composition>
